<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@kehers">
  <meta name="twitter:title" content="Lazy porting - porting J2me apps to Blackberry in 2 easy steps">
  <meta name="twitter:description" content="Our latest work is a mobile app for feature phones and blackberry we have to deliver within a very limited time frame. Due to the time limitation, the fastest route is to develop on a platform (j2m...">
  <meta name="twitter:creator" content="@kehers">
  <title>Lazy porting - porting J2me apps to Blackberry in 2 easy steps</title>
  <link href='https://fonts.googleapis.com/css?family=Libre+Baskerville:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/assets/css/normalize.css">
  <link rel="stylesheet" href="/assets/css/skeleton.css">
  <link rel="stylesheet" href="/assets/css/custom.css">
  <link rel="stylesheet" href="/assets/css/zenburn.css" />
  <link rel="alternate" type="application/atom+xml" title="Blog post feed" href="/feed.xml">
</head>
<body>

<div class="container">
  <header>
    <div class="row">
      <div id="logo" class="three columns">
      <div id="menu">☰</div>
      <h3><a href="/">/opeyemi</a></h3>
    </div>
      <nav class="nine columns">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/posts.html">Posts</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
          <li><a href="http://gum.co/Sxoj" class="bordered">Consuming REST APIs - a soft introduction</a></li>
      </ul>
      </nav>
    </div>
  </header>
  <div class="row">
    <div class="six offset-by-three columns">
      <article>
        <date>18 Nov 2011</date>
        <h1 class="title">Lazy porting - porting J2me apps to Blackberry in 2 easy steps</h1>
        <p><a href="http://digitalcraftstudios.com/">Our</a> latest work is a mobile app for feature phones and blackberry we have to deliver within a very limited time frame. Due to the time limitation, the fastest route is to develop on a platform (j2me for the feature phones) and port to the other (blackberry) instead of building something different for both. Here I share 2 (3 actual) easy steps to porting j2me apps to BB.</p>

<p><strong>1. Kill the menubar</strong><br />App UI on Blackberry (and some other OS like Android) mostly doesn't have the normal bottom menu bar you find in java mobile apps. The reason you find them on j2me apps is because supporting feature phones do have left and right soft keys that can be pinned to specific actions on the app. On BB for example, what you'd find is the '<strong>Menu</strong>' and '<strong>Back</strong>' key. And these however have their own defined functions and is awkward to be attached to a different action. It is therefore clear that clicking the Menu key should access the menu options and the back should go to the previous screen. There is no need of a menu bar to denote this. Since your already made j2me app most probably come with a menubar, the first step is to remove these bars. If there are calculations related to the bar (calculating scrollbars and positions for example), you should adjust as well.<p /><strong>2. Handle the keys</strong><br />Here is where it gets complex. Ugly truth: your key handling will break in BB especially if you are using a high level UI design. Where keycodes like -6 and -7 mean left and right soft keys on feature phones, they mean something different on the BB. Even <em>Canvas.FIRE</em> isn't triggered for BB trackpad/soft ball click or the Enter key. <em>Canvas.FIRE</em> is attached to the spacebar key :/. Where it gets worst is you can't listen to the menu and back key codes with normal j2me midp UI methods. To handle this, you will have to go low level and use <em>Commands</em> and <em>CommandListner</em>. The menu key lists out attached commands for the screen. BACK, CANCEL and EXIT commands are automatically picked up with the Back key while (with just one command attached to the screen) SCREEN, OK and ITEM commands are picked up by Click action and Enter key.</p>

<p><figure class="highlight"><pre><code class="language-java" data-lang="java"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Splash</span> <span class="kd">extends</span> <span class="n">GameCanvas</span> <span class="kd">implements</span> <span class="n">CommandListener</span>
<span class="o">{</span>
    <span class="c1">// ...</span>
    <span class="n">Command</span> <span class="n">OK</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Command</span><span class="o">(</span><span class="s">"Launch"</span><span class="o">,</span> <span class="n">Command</span><span class="o">.</span><span class="na">OK</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
    
    <span class="kd">public</span> <span class="n">Splash</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="c1">// ....</span>
        <span class="k">this</span><span class="o">.</span><span class="na">addCommand</span><span class="o">(</span><span class="n">OK</span><span class="o">);</span>
        <span class="n">setCommandListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="c1">// ....</span>
    <span class="o">}</span>
    
    <span class="c1">//...</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="n">commandAction</span><span class="o">(</span><span class="n">Command</span> <span class="n">command</span><span class="o">,</span> <span class="n">Displayable</span> <span class="n">d</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">command</span> <span class="o">==</span> <span class="n">OK</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">new</span> <span class="n">Gui</span><span class="o">();</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>            
    <span class="o">}</span>
<span class="o">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>[For a sweeter experience, I still tried listening to clicks and enter keys via the keyPressed. Here is my way to it. You don't have to do this though]</p>
<p><figure class="highlight"><pre><code class="language-java" data-lang="java"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre></td><td class="code"><pre><span class="c1">//...</span>
<span class="kn">import</span> <span class="nn">net.rim.device.api.ui.Keypad</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Gui</span> <span class="kd">extends</span> <span class="n">GameCanvas</span> <span class="kd">implements</span> <span class="n">CommandListener</span>
<span class="o">{</span>
    <span class="c1">//...</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">keyPressed</span><span class="o">(</span><span class="kt">int</span> <span class="n">keyCode</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">keyCode</span> <span class="o">==</span> <span class="n">Keypad</span><span class="o">.</span><span class="na">KEY_ENTER</span> <span class="o">||</span> <span class="n">keyCode</span> <span class="o">==</span> <span class="o">-</span><span class="mi">8</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">ok</span><span class="o">();</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="c1">//...</span>
    <span class="o">}</span>
<span class="o">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Also note that if you will be doing this, you will be needing the <em>net.rim.device.api.ui.Keypad</em> class. If you have and using the <a href="http://us.blackberry.com/developers/javaappdev/javadevenv.jsp">Blackberry JDE</a>, you already have it. If not, you can <a href="http://cl.ly/Bv9z">download just that library here</a>.<p /><strong>3. [Optional] Convert to cod</strong><br />While most BB phones support raw jad/jar files, converting to Blackberry's app format (cod and its counterpart application loader file - alx and jad descriptor) is a good thing. There are a couple of ways to do this. If you already have the <a href="http://us.blackberry.com/developers/javaappdev/javadevenv.jsp">Blackberry JDE</a>, just migrate your java codes to the toolkit and build from there (if you are not using this already). If you don't have the JDE and don't want to go through the slow/poor download experience, you can download <a href="http://www.4shared.com/file/7mXvSg3M/vnbbJar2Cod_v10.htm">Jar2Cod</a> a little cool utility for this.</p>
<p>And by the way, you can checkout the apps at <a href="http://smetoolkit.digitalcraftstudios.com/">http://smetoolkit.digitalcraftstudios.com/</a></p>

      </article>
    </div>
  </div>
</div>
<div class="colophon">
  <div class="container">
    <div class="row">
      <div class="author six offset-by-three columns">
        <img src="https://igcdn-photos-f-a.akamaihd.net/hphotos-ak-xfp1/t51.2885-15/e15/10617063_553407278119581_1973098870_n.jpg" class="avi"> <p>My name is Opeyemi Obembe. I build things for web and mobile. You should follow me on Twitter (<a href="http://twitter.com/kehers">@kehers</a>).</p>
      </div>
    </div>
    <div class="row p-t-20">
      <div class="six offset-by-three columns">
        
        
        
        <article class="m-t-20">
          <h4 class="title m-b-20">Next post</h4>
          <h5 class="libre no-margin"><a href="/2011/11/06/and-so-i-got-a-bb.html">And so I got a BB</a></h5>
        </article>
        
        <h4 class="title">Comments</h4>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_shortname = 'kehers';
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="three offset-by-three columns">
        <a href="/">/opeyemi</a> · <a href="http://github.com/kehers/kehers.github.com">Source</a> · <a href="/feed.xml">RSS feed</a>
      </div>
      <div class="three columns">
        <a href="http://twitter.com/kehers">Twitter</a> · <a href="http://github.com/kehers">Github</a> · <a href="http://instagram.com/kehers">Instagram</a> · <a href="http://500px.com/kehers">500px</a>
    </div>
    </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/js/menu.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-53373832-1', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>